    <%# CAMPO: Commune %>
    <%= turbo_frame_tag "field_commune" do %>
      <%= form_with(url: panel_onboarding_step1_path, method: :patch, data: { turbo_frame: "step1_form" }) do |form| %>
        <%
          # Helper para clase de selector
          def select_class(value)
            return "select-success" if value.present?
            ""
          end
          communes = cascading_data.find { |r| r[:id] == selected_region_id.to_i }&.dig(:communes) || []
        %>
        <label class="floating-label">
          <%= form.select :commune_id,
              options_for_select(communes.map { |c| [c[:name], c[:id]] }, selected_commune_id),
              { prompt: I18n.t('onboarding.step1.select_commune') },
              { class: "select w-full #{select_class(selected_commune_id)}", disabled: communes.empty?, onchange: "this.form.requestSubmit()" }
          %>
          <span><%= I18n.t('onboarding.step1.commune_label') %></span>
        </label>
        <%= hidden_field_tag :region_id, selected_region_id %>
      <% end %>
    <% end %>